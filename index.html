<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Gala 2025</title>

<style>
body{
  margin:0;
  background:#000;
  color:#fff;
  font-family:system-ui, -apple-system, Segoe UI, Roboto;
}
.wrap{
  max-width:900px;
  margin:auto;
  padding:2rem;
}
h1{
  letter-spacing:.1em;
  text-transform:uppercase;
}
.sub{
  color:#e34b4b;
  letter-spacing:.2em;
  margin-bottom:2rem;
}
input,button{
  background:#111;
  color:#fff;
  border:1px solid #333;
  padding:.7rem 1rem;
  border-radius:10px;
}
button{ cursor:pointer; }
.menu{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(160px,1fr));
  gap:1rem;
  margin-top:2rem;
}
.menu a{
  text-align:center;
  text-decoration:none;
  color:#fff;
  border:1px solid #333;
  padding:1rem;
  border-radius:14px;
}
.hidden{ display:none; }

.overlay{
  position:fixed;
  inset:0;
  background:#000;
  overflow:auto;
  padding:2rem;
}
.card{
  border:1px solid #333;
  border-radius:14px;
  padding:1rem;
  margin-top:1rem;
}
.vote-line{
  display:grid;
  grid-template-columns:1fr 80px;
  gap:1rem;
  margin:.4rem 0;
}
.vote-line input{
  text-align:center;
}
.ok{ color:#22c55e; }
.err{ color:#ef4444; }
</style>
</head>

<body>
<div class="wrap">
  <h1 id="titulo">Gala 2025</h1>
  <div class="sub">Make Lostios Great Again</div>

  <div id="login">
    <input id="clave" type="password" placeholder="Código">
    <button onclick="login()">Entrar</button>
    <div id="msg"></div>
  </div>

  <div id="menu" class="menu hidden">
    <a href="#" onclick="abrirVotaciones()">Votaciones</a>
    <a href="https://maps.app.goo.gl/KUfR8wCoTkdzYVhE7" target="_blank">Ubicación</a>
    <a href="https://files.maldita.es/maldita/uploads/undated/foto%20gorila%20broma.jpg" target="_blank">Highlights</a>
  </div>
</div>

<div id="votaciones" class="overlay hidden"></div>

<script>
/* ===== CONFIG ADMIN ===== */
const VOTES_ENDPOINT = "https://script.google.com/macros/s/AKfycbznlHNrTxbNC4hlz69O3XgcKmKSmUh6Pw7A6H3wU9J_PQthdBmtYCpRYC6vSgnsgyLOLQ/exec";
const TOKEN = "GALA2025_SECRETO";

/* ===== DATOS ===== */
const CLAVES = {
 peseta:"Arturo", escopeta:"Xiki", bet365:"Enrique",
 lamatera:"Sergi", julian:"Javi", largo:"Largo",
 salitre:"Lucas", traepan:"Nico", gaficas:"Alvarico",
 eoldlb:"Raul", admin:"Yuca"
};
const INTEGRANTES = ["Arturo","Xiki","Enrique","Sergi","Javi","Largo","Lucas","Nico","Alvarico","Raul","Yuca"];
const CATS = [
 {id:"mas_ennoviao",t:"Más ennoviao"},
 {id:"mejor_estilo",t:"Mejor estilazo de ropa"},
 {id:"mas_cunao",t:"Más cuñao"},
 {id:"mas_fiestero",t:"Más fiestero"}
];

let usuario=null, paso=0, votos={};

/* ===== LOGIN ===== */
function login(){
 const v=document.getElementById("clave").value.toLowerCase().trim();
 const msg=document.getElementById("msg");
 if(CLAVES[v]){
   usuario=CLAVES[v];
   msg.textContent="Bienvenido, "+usuario;
   msg.className="ok";
   document.getElementById("login").style.display="none";
   document.getElementById("menu").classList.remove("hidden");
 }else{
   msg.textContent="Código incorrecto";
   msg.className="err";
 }
}

/* ===== VOTACIONES ===== */
function abrirVotaciones(){
 paso=0; votos={};
 document.getElementById("votaciones").classList.remove("hidden");
 render();
}

function cerrar(){
 document.getElementById("votaciones").classList.add("hidden");
}

function render(){
 const box=document.getElementById("votaciones");
 if(paso===0){
   box.innerHTML=`
   <div class="card">
    <h2>Votaciones 2025</h2>
    <p>Votarás 4 categorías puntuando del 1 al 10.</p>
    <button onclick="paso=1;render()">Empezar</button>
    <button onclick="cerrar()">Cerrar</button>
   </div>`;
   return;
 }
 if(paso>=1 && paso<=4){
   const cat=CATS[paso-1];
   let html=`<div class="card"><h3>${cat.t}</h3>`;
   INTEGRANTES.forEach(n=>{
     html+=`
     <div class="vote-line">
      <label>${n}</label>
      <input type="number" min="1" max="10" id="${cat.id}_${n}">
     </div>`;
   });
   html+=`
    <button onclick="guardar('${cat.id}')">Siguiente</button>
    <button onclick="cerrar()">Cerrar</button>
   </div>`;
   box.innerHTML=html;
   return;
 }
 if(paso===5){
   box.innerHTML=`
   <div class="card">
    <h3>Confirmar voto</h3>
    <button onclick="enviar()">Enviar voto</button>
    <button onclick="cerrar()">Cerrar</button>
   </div>`;
 }
}

function guardar(cat){
 votos[cat]={};
 for(const n of INTEGRANTES){
  const v=Number(document.getElementById(cat+"_"+n).value);
  if(v<1||v>10){ alert("Valores 1–10"); return; }
  votos[cat][n]=v;
 }
 paso++; render();
}

async function enviar(){
 const payload=new URLSearchParams({
  token:TOKEN,
  payload:JSON.stringify({
   voter:usuario,
   submittedAt:new Date().toISOString(),
   scores:votos
  })
 });
 await fetch(VOTES_ENDPOINT,{method:"POST",body:payload});
 alert("Voto enviado. Gracias.");
 cerrar();
}
</script>
</body>
</html>
